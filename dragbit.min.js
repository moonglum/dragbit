(function(f){var c,e,d;d={fairlyHighZIndex:"10",setup:function(a,b){a.css("position","absolute");a.data("shadowMode",b.shadowMode);a.data("moveX",b.moveX);a.data("moveY",b.moveY);b.handle.mousedown(function(b){d.startDragging(b,a)});a.bind("dragStart",b.dragStart);a.bind("dragging",b.dragging);a.bind("dragStop",b.dragStop)},addDocumentListeners:function(){document.addEventListener("selectstart",d.cancelDocumentSelection);document.addEventListener("mousemove",d.continueDragging);document.addEventListener("mouseup",
d.stopDragging)},removeDocumentListeners:function(){document.removeEventListener("selectstart",d.cancelDocumentSelection);document.removeEventListener("mousemove",d.continueDragging);document.removeEventListener("mouseup",d.stopDragging)},startDragging:function(a,b){var g=b.position();b.data("shadowMode")&&(console.log("activated shadow mode"),e=b.clone(),b.after(e),e.css("opacity",0.3));b.prependTo(f("body"));b.css("top",g.top);b.css("left",g.left);d.bringToFront(b);c=b;d.moveCurrentElement(a,c.position());
d.addDocumentListeners();c.trigger("dragStart",c.position())},continueDragging:function(a){d.moveCurrentElement(a,d.calculateNewPosition(a));c.trigger("dragging",c.position())},stopDragging:function(){c.data("shadowMode")&&e.remove();d.removeDocumentListeners();c.trigger("dragStop",c.position())},bringToFront:function(a){c&&c.css("z-index",d.fairlyHighZIndex-1);a.css("z-index",d.fairlyHighZIndex)},moveCurrentElement:function(a,b){c.data("moveX")&&(c.css("left",b.left),c.data("lastXPosition",a.clientX));
c.data("moveY")&&(c.css("top",b.top),c.data("lastYPosition",a.clientY))},calculateNewPosition:function(a){var b=parseInt(c.css("left"),10),d=parseInt(c.css("top"),10);return{left:b+(a.clientX-c.data("lastXPosition")),top:d+(a.clientY-c.data("lastYPosition"))}},cancelDocumentSelection:function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();return a.returnValue=!1}};f.fn.draggable=function(a){a=f.extend({handle:this,dragStart:function(){},dragging:function(){},dragStop:function(){},
shadowMode:!1,moveX:!0,moveY:!0},a);d.setup(this,a);return this}})(jQuery);
