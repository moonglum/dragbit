(function(f){var c,e,d;d={fairlyHighZIndex:"10",setup:function(a,b){a.css("position","absolute");a.css("left",b.originalPosition.left);a.css("top",b.originalPosition.top);a.data("shadowMode",b.shadowMode);a.data("moveX",b.moveX);a.data("moveY",b.moveY);a.data("lockInContainer",b.lockInContainer);a.data("container",a.parent());b.handle.mousedown(function(b){d.startDragging(b,a)});a.bind("dragStart",b.dragStart);a.bind("dragging",b.dragging);a.bind("dragStop",b.dragStop)},addDocumentListeners:function(){document.addEventListener("selectstart",
d.cancelDocumentSelection);document.addEventListener("mousemove",d.continueDragging);document.addEventListener("mouseup",d.stopDragging)},removeDocumentListeners:function(){document.removeEventListener("selectstart",d.cancelDocumentSelection);document.removeEventListener("mousemove",d.continueDragging);document.removeEventListener("mouseup",d.stopDragging)},startDragging:function(a,b){var j=b.position();b.data("shadowMode")&&(e=b.clone(),b.after(e),e.css("opacity",0.3));b.prependTo(f("body"));b.css("top",
j.top);b.css("left",j.left);d.bringToFront(b);c=b;d.moveCurrentElement(a,c.position());d.addDocumentListeners();c.trigger("dragStart",c.position())},continueDragging:function(a){d.moveCurrentElement(a,d.calculateNewPosition(a));c.trigger("dragging",c.position())},stopDragging:function(){c.data("shadowMode")&&e.remove();c.data("lockInContainer")&&c.data("container").append(c);d.removeDocumentListeners();c.trigger("dragStop",c.position())},bringToFront:function(a){c&&c.css("z-index",d.fairlyHighZIndex-
1);a.css("z-index",d.fairlyHighZIndex)},moveCurrentElement:function(a,b){window.getSelection().removeAllRanges();if(!c.data("lockInContainer")||d.checkBoundaries(b))c.data("moveX")&&(c.css("left",b.left),c.data("lastXPosition",a.clientX)),c.data("moveY")&&(c.css("top",b.top),c.data("lastYPosition",a.clientY))},checkBoundaries:function(a){var b=!0,d=c.data("container"),f=d.position().top,e=d.position().left,g=parseInt(d.css("width"),10),g=e+g,h=parseInt(d.css("height"),10),d=d.position().top+h,h=a.top;
a=a.left;var k=parseInt(c.css("width"),10),m=a+k,l=parseInt(c.css("height"),10),n=h+l;f>h&&(c.css("top",f+1),b=!1);e>a&&(c.css("left",e+1),b=!1);g<m&&(c.css("left",g-k-1),b=!1);d<n&&(c.css("top",d-l-1),b=!1);return b},calculateNewPosition:function(a){var b=parseInt(c.css("left"),10),d=parseInt(c.css("top"),10);return{left:b+(a.clientX-c.data("lastXPosition")),top:d+(a.clientY-c.data("lastYPosition"))}},cancelDocumentSelection:function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();
return a.returnValue=!1}};f.fn.draggable=function(a){this.each(function(){var b=f(this),c=f.extend({handle:b,dragStart:function(){},dragging:function(){},dragStop:function(){},shadowMode:!1,moveX:!0,moveY:!0,lockInContainer:!1,originalPosition:b.position()},a);setTimeout(function(){d.setup(b,c)},100)});return this}})(jQuery);
